""" input datalarını eğitim kısmındaki gibi -1 ve 1 arasına scale ederek vericeksin unutma"""
from PyQt5 import QtCore, QtGui, QtWidgets
import numpy as np
import pandas as pd
import os, sys
from sklearn.preprocessing import MinMaxScaler
import tensorflow as tf
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from keras.models import load_model
model = load_model('parkinsons_ann_model.h5')

#%%

from PyQt5 import QtCore, QtGui, QtWidgets



class Ui_Form(object):
    def setupUi(self, Form):
        Form.setObjectName("Form")
        Form.resize(571, 534)
        Form.setAutoFillBackground(False)
        Form.setStyleSheet("background-color: rgb(254, 235, 255);")
        self.pushButton = QtWidgets.QPushButton(Form)
        self.pushButton.setGeometry(QtCore.QRect(70, 400, 121, 41))
        self.pushButton.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.pushButton.setObjectName("pushButton")
        self.Fo_LineEdit = QtWidgets.QLineEdit(Form)
        self.Fo_LineEdit.setGeometry(QtCore.QRect(120, 40, 91, 22))
        self.Fo_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.Fo_LineEdit.setObjectName("Fo_LineEdit")
        self.Jitter_LineEdit = QtWidgets.QLineEdit(Form)
        self.Jitter_LineEdit.setGeometry(QtCore.QRect(120, 130, 91, 22))
        self.Jitter_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.Jitter_LineEdit.setObjectName("Jitter_LineEdit")
        self.Flo_LineEdit = QtWidgets.QLineEdit(Form)
        self.Flo_LineEdit.setGeometry(QtCore.QRect(120, 100, 91, 22))
        self.Flo_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.Flo_LineEdit.setObjectName("Flo_LineEdit")
        self.RAP_LineEdit = QtWidgets.QLineEdit(Form)
        self.RAP_LineEdit.setGeometry(QtCore.QRect(120, 190, 91, 22))
        self.RAP_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.RAP_LineEdit.setObjectName("RAP_LineEdit")
        self.JitterAbs_LineEdit = QtWidgets.QLineEdit(Form)
        self.JitterAbs_LineEdit.setGeometry(QtCore.QRect(120, 160, 91, 22))
        self.JitterAbs_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.JitterAbs_LineEdit.setObjectName("JitterAbs_LineEdit")
        self.Fhi_LineEdit = QtWidgets.QLineEdit(Form)
        self.Fhi_LineEdit.setGeometry(QtCore.QRect(120, 70, 91, 22))
        self.Fhi_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.Fhi_LineEdit.setObjectName("Fhi_LineEdit")
        self.PPQ_LineEdit = QtWidgets.QLineEdit(Form)
        self.PPQ_LineEdit.setGeometry(QtCore.QRect(120, 220, 91, 22))
        self.PPQ_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.PPQ_LineEdit.setObjectName("PPQ_LineEdit")
        self.ShimmerDB_LineEdit = QtWidgets.QLineEdit(Form)
        self.ShimmerDB_LineEdit.setGeometry(QtCore.QRect(120, 310, 91, 22))
        self.ShimmerDB_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.ShimmerDB_LineEdit.setObjectName("ShimmerDB_LineEdit")
        self.APQ3_LineEdit = QtWidgets.QLineEdit(Form)
        self.APQ3_LineEdit.setGeometry(QtCore.QRect(120, 340, 91, 22))
        self.APQ3_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.APQ3_LineEdit.setObjectName("APQ3_LineEdit")
        self.DDP_LineEdit = QtWidgets.QLineEdit(Form)
        self.DDP_LineEdit.setGeometry(QtCore.QRect(120, 250, 91, 22))
        self.DDP_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.DDP_LineEdit.setObjectName("DDP_LineEdit")
        self.Shimmer_LineEdit = QtWidgets.QLineEdit(Form)
        self.Shimmer_LineEdit.setGeometry(QtCore.QRect(120, 280, 91, 22))
        self.Shimmer_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.Shimmer_LineEdit.setObjectName("Shimmer_LineEdit")
        self.PPE_LineEdit = QtWidgets.QLineEdit(Form)
        self.PPE_LineEdit.setGeometry(QtCore.QRect(380, 340, 91, 22))
        self.PPE_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.PPE_LineEdit.setObjectName("PPE_LineEdit")
        self.DFA_LineEdit = QtWidgets.QLineEdit(Form)
        self.DFA_LineEdit.setGeometry(QtCore.QRect(380, 220, 91, 22))
        self.DFA_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.DFA_LineEdit.setObjectName("DFA_LineEdit")
        self.APQ5_LineEdit = QtWidgets.QLineEdit(Form)
        self.APQ5_LineEdit.setGeometry(QtCore.QRect(380, 40, 91, 22))
        self.APQ5_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.APQ5_LineEdit.setObjectName("APQ5_LineEdit")
        self.NHR_LineEdit = QtWidgets.QLineEdit(Form)
        self.NHR_LineEdit.setGeometry(QtCore.QRect(380, 130, 91, 22))
        self.NHR_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.NHR_LineEdit.setObjectName("NHR_LineEdit")
        self.D2_LineEdit = QtWidgets.QLineEdit(Form)
        self.D2_LineEdit.setGeometry(QtCore.QRect(380, 310, 91, 22))
        self.D2_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.D2_LineEdit.setObjectName("D2_LineEdit")
        self.HNR_LineEdit = QtWidgets.QLineEdit(Form)
        self.HNR_LineEdit.setGeometry(QtCore.QRect(380, 160, 91, 22))
        self.HNR_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.HNR_LineEdit.setObjectName("HNR_LineEdit")
        self.APQ_LineEdit = QtWidgets.QLineEdit(Form)
        self.APQ_LineEdit.setGeometry(QtCore.QRect(380, 70, 91, 22))
        self.APQ_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.APQ_LineEdit.setObjectName("APQ_LineEdit")
        self.spread1_LineEdit = QtWidgets.QLineEdit(Form)
        self.spread1_LineEdit.setGeometry(QtCore.QRect(380, 250, 91, 22))
        self.spread1_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.spread1_LineEdit.setObjectName("spread1_LineEdit")
        self.Spread2_LineEdit = QtWidgets.QLineEdit(Form)
        self.Spread2_LineEdit.setGeometry(QtCore.QRect(380, 280, 91, 22))
        self.Spread2_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.Spread2_LineEdit.setObjectName("Spread2_LineEdit")
        self.DDA_LineEdit = QtWidgets.QLineEdit(Form)
        self.DDA_LineEdit.setGeometry(QtCore.QRect(380, 100, 91, 22))
        self.DDA_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.DDA_LineEdit.setObjectName("DDA_LineEdit")
        self.RPDE_LineEdit = QtWidgets.QLineEdit(Form)
        self.RPDE_LineEdit.setGeometry(QtCore.QRect(380, 190, 91, 22))
        self.RPDE_LineEdit.setStyleSheet("background-color: rgb(255, 255, 255);")
        self.RPDE_LineEdit.setObjectName("RPDE_LineEdit")
        self.Fo_Label = QtWidgets.QLabel(Form)
        self.Fo_Label.setGeometry(QtCore.QRect(20, 40, 21, 16))
        self.Fo_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.Fo_Label.setObjectName("Fo_Label")
        self.Fhi_Label = QtWidgets.QLabel(Form)
        self.Fhi_Label.setGeometry(QtCore.QRect(20, 70, 31, 16))
        self.Fhi_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.Fhi_Label.setObjectName("Fhi_Label")
        self.Flo_Label = QtWidgets.QLabel(Form)
        self.Flo_Label.setGeometry(QtCore.QRect(20, 100, 31, 16))
        self.Flo_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.Flo_Label.setObjectName("Flo_Label")
        self.Jitter_Label = QtWidgets.QLabel(Form)
        self.Jitter_Label.setGeometry(QtCore.QRect(20, 130, 61, 20))
        self.Jitter_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.Jitter_Label.setObjectName("Jitter_Label")
        self.JitterAbs_Label = QtWidgets.QLabel(Form)
        self.JitterAbs_Label.setGeometry(QtCore.QRect(20, 160, 71, 20))
        self.JitterAbs_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.JitterAbs_Label.setObjectName("JitterAbs_Label")
        self.RAP_Label = QtWidgets.QLabel(Form)
        self.RAP_Label.setGeometry(QtCore.QRect(20, 190, 31, 16))
        self.RAP_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.RAP_Label.setObjectName("RAP_Label")
        self.PPQ_Label = QtWidgets.QLabel(Form)
        self.PPQ_Label.setGeometry(QtCore.QRect(20, 220, 31, 16))
        self.PPQ_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.PPQ_Label.setObjectName("PPQ_Label")
        self.DDP_Label = QtWidgets.QLabel(Form)
        self.DDP_Label.setGeometry(QtCore.QRect(20, 250, 31, 16))
        self.DDP_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.DDP_Label.setObjectName("DDP_Label")
        self.Shimmer_Label = QtWidgets.QLabel(Form)
        self.Shimmer_Label.setGeometry(QtCore.QRect(20, 280, 61, 20))
        self.Shimmer_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.Shimmer_Label.setObjectName("Shimmer_Label")
        self.ShimmerDB_Label = QtWidgets.QLabel(Form)
        self.ShimmerDB_Label.setGeometry(QtCore.QRect(20, 310, 91, 20))
        self.ShimmerDB_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.ShimmerDB_Label.setObjectName("ShimmerDB_Label")
        self.APQ3_Label = QtWidgets.QLabel(Form)
        self.APQ3_Label.setGeometry(QtCore.QRect(20, 340, 51, 20))
        self.APQ3_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.APQ3_Label.setObjectName("APQ3_Label")
        self.APQ5_Label = QtWidgets.QLabel(Form)
        self.APQ5_Label.setGeometry(QtCore.QRect(310, 40, 51, 20))
        self.APQ5_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.APQ5_Label.setObjectName("APQ5_Label")
        self.APQ_Label = QtWidgets.QLabel(Form)
        self.APQ_Label.setGeometry(QtCore.QRect(310, 70, 51, 20))
        self.APQ_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.APQ_Label.setObjectName("APQ_Label")
        self.DDA_Label = QtWidgets.QLabel(Form)
        self.DDA_Label.setGeometry(QtCore.QRect(310, 100, 51, 20))
        self.DDA_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.DDA_Label.setObjectName("DDA_Label")
        self.NHR_Label = QtWidgets.QLabel(Form)
        self.NHR_Label.setGeometry(QtCore.QRect(310, 130, 51, 20))
        self.NHR_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.NHR_Label.setObjectName("NHR_Label")
        self.HNR_Label = QtWidgets.QLabel(Form)
        self.HNR_Label.setGeometry(QtCore.QRect(310, 160, 51, 20))
        self.HNR_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.HNR_Label.setObjectName("HNR_Label")
        self.RPDE_Label = QtWidgets.QLabel(Form)
        self.RPDE_Label.setGeometry(QtCore.QRect(310, 190, 51, 20))
        self.RPDE_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.RPDE_Label.setObjectName("RPDE_Label")
        self.DFA_Label = QtWidgets.QLabel(Form)
        self.DFA_Label.setGeometry(QtCore.QRect(310, 220, 51, 20))
        self.DFA_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.DFA_Label.setObjectName("DFA_Label")
        self.spread_Label = QtWidgets.QLabel(Form)
        self.spread_Label.setGeometry(QtCore.QRect(310, 250, 51, 20))
        self.spread_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.spread_Label.setObjectName("spread_Label")
        self.spread2_Label = QtWidgets.QLabel(Form)
        self.spread2_Label.setGeometry(QtCore.QRect(310, 280, 61, 20))
        self.spread2_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.spread2_Label.setObjectName("spread2_Label")
        self.D2_Label = QtWidgets.QLabel(Form)
        self.D2_Label.setGeometry(QtCore.QRect(310, 310, 51, 20))
        self.D2_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.D2_Label.setObjectName("D2_Label")
        self.PPE_Label = QtWidgets.QLabel(Form)
        self.PPE_Label.setGeometry(QtCore.QRect(310, 340, 51, 20))
        self.PPE_Label.setStyleSheet("font: 75 9pt \"Tahoma\";")
        self.PPE_Label.setObjectName("PPE_Label")
        self.PredictedLabel_textBrowser = QtWidgets.QTextBrowser(Form)
        self.PredictedLabel_textBrowser.setGeometry(QtCore.QRect(310, 410, 201, 31))
        self.PredictedLabel_textBrowser.setStyleSheet("background-color: rgb(255, 255, 255);\n"
"font: 75 9pt \"Tahoma\";")
        self.PredictedLabel_textBrowser.setObjectName("PredictedLabel_textBrowser")
        self.Predicted_Label = QtWidgets.QLabel(Form)
        self.Predicted_Label.setGeometry(QtCore.QRect(310, 390, 131, 20))
        self.Predicted_Label.setScaledContents(False)
        self.Predicted_Label.setObjectName("Predicted_Label")
        self.pushButton.clicked.connect(self.clicked) #clicked function
        self.retranslateUi(Form)
        QtCore.QMetaObject.connectSlotsByName(Form)

    def retranslateUi(self, Form):
        _translate = QtCore.QCoreApplication.translate
        Form.setWindowTitle(_translate("Form", "Parkinson Detection Application"))
        self.pushButton.setText(_translate("Form", "Onayla"))
        self.Fo_Label.setText(_translate("Form", "Fo"))
        self.Fhi_Label.setText(_translate("Form", "Fhi"))
        self.Flo_Label.setText(_translate("Form", "Flo"))
        self.Jitter_Label.setText(_translate("Form", "Jitter(%)"))
        self.JitterAbs_Label.setText(_translate("Form", "Jitter(abs)"))
        self.RAP_Label.setText(_translate("Form", "RAP"))
        self.PPQ_Label.setText(_translate("Form", "PPQ"))
        self.DDP_Label.setText(_translate("Form", "DDP"))
        self.Shimmer_Label.setText(_translate("Form", "Shimmer"))
        self.ShimmerDB_Label.setText(_translate("Form", "Shimmer(dB)"))
        self.APQ3_Label.setText(_translate("Form", "APQ3"))
        self.APQ5_Label.setText(_translate("Form", "APQ5"))
        self.APQ_Label.setText(_translate("Form", "APQ"))
        self.DDA_Label.setText(_translate("Form", "DDA"))
        self.NHR_Label.setText(_translate("Form", "NHR"))
        self.HNR_Label.setText(_translate("Form", "HNR"))
        self.RPDE_Label.setText(_translate("Form", "RPDE"))
        self.DFA_Label.setText(_translate("Form", "DFA"))
        self.spread_Label.setText(_translate("Form", "Spread1"))
        self.spread2_Label.setText(_translate("Form", "Spread2"))
        self.D2_Label.setText(_translate("Form", "D2"))
        self.PPE_Label.setText(_translate("Form", "PPE"))
        self.Predicted_Label.setText(_translate("Form", "Sonuç"))


    def clicked(self):
        test_data = np.ndarray(shape=(1,22), dtype= float, order='F')
        test_data[0,0] = (float(self.Fo_LineEdit.text()))
        test_data[0,1] = (float(self.Fhi_LineEdit.text()))
        test_data[0,2] = (float(self.Flo_LineEdit.text()))
        test_data[0,3] = (float(self.Jitter_LineEdit.text()))
        test_data[0,4] = (float(self.JitterAbs_LineEdit.text()))
        test_data[0,5] = (float(self.RAP_LineEdit.text()))
        test_data[0,6] = (float(self.PPQ_LineEdit.text()))
        test_data[0,7] = (float(self.DDP_LineEdit.text()))
        test_data[0,8] = (float(self.Shimmer_LineEdit.text()))
        test_data[0,9] = (float(self.ShimmerDB_LineEdit.text()))
        test_data[0,10] = (float(self.APQ3_LineEdit.text()))
        test_data[0,11] = (float(self.APQ5_LineEdit.text()))
        test_data[0,12] = (float(self.APQ_LineEdit.text()))
        test_data[0,13] = (float(self.DDA_LineEdit.text()))
        test_data[0,14] = (float(self.NHR_LineEdit.text()))
        test_data[0,15] = (float(self.HNR_LineEdit.text()))
        test_data[0,16] = (float(self.RPDE_LineEdit.text()))
        test_data[0,17] = (float(self.DFA_LineEdit.text()))
        test_data[0,18] = (float(self.spread1_LineEdit.text()))
        test_data[0,19] = (float(self.Spread2_LineEdit.text()))
        test_data[0,20] = (float(self.D2_LineEdit.text()))
        test_data[0,21] = (float(self.PPE_LineEdit.text()))
        test_data = np.expand_dims(test_data, axis=2)
        print(test_data.shape)
        predicted = model.predict_classes(test_data, batch_size=64, verbose=0)
        print(predicted)
        if predicted == 1:    
            self.PredictedLabel_textBrowser.setText("Parkinson Detected")
        else:
            self.PredictedLabel_textBrowser.setText("Parkinson Not Detected")
        return test_data
    
if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    Form = QtWidgets.QWidget()
    ui = Ui_Form()
    ui.setupUi(Form)
    Form.show()
   
    
    sys.exit(app.exec_())
    















